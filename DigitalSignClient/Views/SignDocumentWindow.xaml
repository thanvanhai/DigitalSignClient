<Window x:Class="DigitalSignClient.Views.SignDocumentWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="Ký tài liệu" Height="900" Width="1100"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Background="#F5F5F5" Padding="10" 
                BorderBrush="#DDDDDD" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="BtnToggleInk" 
                        Content="🖊️ Bật ký tay" 
                        Click="ToggleInk_Click" 
                        Margin="4" Padding="12,6" 
                        Background="White" 
                        BorderBrush="#CCCCCC"/>

                <!-- ✅ NÚT MỚI: Xong - Chọn vị trí -->
                <Button x:Name="BtnDoneDrawing" 
                        Content="✓ Xong - Chọn vị trí" 
                        Click="DoneDrawing_Click" 
                        Margin="4" Padding="12,6" 
                        Background="#2196F3" 
                        Foreground="White"
                        BorderBrush="#2196F3"
                        FontWeight="Bold"
                        Visibility="Collapsed"/>

                <Button Content="🗑️ Xóa ký" 
                        Click="ClearInk_Click" 
                        Margin="4" Padding="12,6" 
                        Background="White" 
                        BorderBrush="#CCCCCC"/>
                <Button Content="✓ Xác nhận ký" 
                        Click="Confirm_Click" 
                        Margin="4" Padding="12,6" 
                        Background="#4CAF50" 
                        Foreground="White" 
                        BorderBrush="#4CAF50" 
                        FontWeight="Bold"/>
                <Button Content="✕ Đóng" 
                        Click="Close_Click" 
                        Margin="4" Padding="12,6" 
                        Background="#F44336" 
                        Foreground="White" 
                        BorderBrush="#F44336"/>
            </StackPanel>
        </Border>

        <!-- PDF Viewer + Overlay -->
        <Grid Grid.Row="1">
            <wv2:WebView2 x:Name="PdfViewer" />

            <Image x:Name="PdfSnapshot" 
                   Visibility="Collapsed" 
                   Stretch="Uniform"/>

            <Canvas x:Name="ClickCanvas"
                    Background="Transparent"
                    MouseLeftButtonDown="ClickCanvas_MouseLeftButtonDown"/>

            <InkCanvas x:Name="InkArea"
                       Visibility="Collapsed"
                       Background="#10000000"/>

            <!-- Hướng dẫn -->
            <Border x:Name="InstructionPanel"
                    Background="#DD2196F3"
                    CornerRadius="8"
                    Padding="15"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    Margin="0,0,0,20"
                    Visibility="Collapsed">
                <TextBlock x:Name="InstructionText"
                           Foreground="White"
                           FontSize="16"
                           FontWeight="Bold"
                           TextAlignment="Center"
                           Text=""/>
            </Border>
        </Grid>
    </Grid>
</Window>